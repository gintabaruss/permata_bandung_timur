<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>PERMATA BANTIM MINI APP!</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

  body{
    font-family:'Press Start 2P', monospace;
    margin:0;
    /* Ubah background body menjadi pink muda */
    background:#00FFCC; 
  }
  *{
    font-family:'Press Start 2P', monospace !important;
    letter-spacing:1px;
  }

  /* SCREEN FRAME */
  .screen-frame{
    width:auto;
    height:747px;
    background:#00FFCC; /* Tetap hijau gelap untuk kontras layar retro */
    margin:5px auto 0;
    margin-left:5px;margin-right:5px;
    border-radius:10px;
    border:6px solid #000;
    position:relative;
    padding:10;
    overflow: hidden;
  }

  .screen-frame::after{
    content:"";
    position:relative;
    inset:0;
    /* Pertahankan efek scanline hijau */
    background:linear-gradient(rgba(0,255,0,0.1) 2px, transparent 2px),
                linear-gradient(90deg, rgba(0,255,0,0.1) 2px, transparent 2px);
    background-size:4px 4px;
    pointer-events:none;
  }
.screen-frame2{
    width:auto;
    height:747px;
    background:#00FFCC; /* Tetap hijau gelap untuk kontras layar retro */
    margin:5px auto 0;
    margin-left:5px;margin-right:5px;
    border-radius:10px;
    position:relative;
    padding:10;
    overflow: hidden;
  }

  .screen-frame2::after{
    content:"";
    position:relative;
    inset:0;
    /* Pertahankan efek scanline hijau */
    pointer-events:none;
  }
  /* SCREEN CONTENT */
  .app{
    width:100%;height:100%;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    color:#000; /* Tetap hijau terang */
    overflow-y: auto;
  }

  header{
      display:flex;
  } 

  /* MENU BUTTONS OUTSIDE SCREEN */
  #main-menu{
     display:flex;
      justify-content:center;
      align-items:center;
    gap:16px;
    padding:20px;
    width: 100%; 
    box-sizing: border-box;
    /* Memberi latar belakang untuk area menu agar terlihat lebih pink */
    background: #BFFFFD; 
    border-radius: 10px;
  }
  
 #btn1{
     display:none;
}
    
  #btn{
     padding:14px;
    border-radius:10px;
    background:#BFFFFD;
    font-size:10px;
    cursor:pointer;
    border:4px solid #000;
    color:#000;
    text-align:center;
    box-shadow:0 4px 0 #000;
    user-select: none;
  }

  #btn:active{
    box-shadow: 0 0 0 #000;
    transform: translateY(4px);
  }
  /* SECTIONS */
  .section{display:none;padding:20px;color:#000;width:100%;box-sizing: border-box;text-shadow: none; overflow-y: auto;}
  .back{background:#ddd;color:#000;margin-bottom:12px;border-radius:8px;padding:8px 12px;width:max-content;cursor:pointer;border:2px solid #000;font-size:10px;}  
  .section h2{font-size: 16px; margin-top: 0; margin-bottom: 15px;}
  .section p{font-size:12px; line-height: 1.6;}
  /* SECTIONS 2 */
  .section2{display:none;padding:20px;color:#000;width:100%;box-sizing: border-box;text-shadow: none; overflow-y: auto;}
  .back2{background:#ddd;color:#000;margin-bottom:12px;border-radius:8px;padding:8px 12px;width:max-content;cursor:pointer;border:2px solid #000;font-size:10px;}  
  .section2 h2{font-size: 16px; margin-top: 0; margin-bottom: 15px;}
  .section2 p{font-size:12px; line-height: 1.6;}
  /* SECTIONS 3 */
  .section3{display:none;padding:20px;color:#000;width:100%;box-sizing: border-box;text-shadow: none; overflow-y: auto;}
  .back3{background:#ddd;color:#000;margin-bottom:12px;border-radius:8px;padding:8px 12px;width:max-content;cursor:pointer;border:2px solid #000;font-size:10px;}  
  .section3 h2{font-size: 16px; margin-top: 0; margin-bottom: 15px;}
  .section3 p{font-size:12px; line-height: 1.6;}
  
/* ===== Photobooth mini + Photostrip CSS ===== */
.photobooth-wrap {
  display: flex;
  gap: 12px;
  align-items: center;
  justify-content: center;
  box-sizing: border-box;

}

/* kiri: video + controls */
.photobooth-left {

  display: flex;
  flex-direction: column;
  gap: 8px;
}

/* kanan: preview strip + download */
.photobooth-right {
 widht:auto;
 height:auto;
  display: flex;
  flex-direction: column;
  gap: 8px;
  align-items: center;
}

/* video kamera (mini) */
.photobooth-wrap #camera {
    transform:scaleX(-1);
  width: 800px;
  height: 600px;            /* tinggi tetap agar proporsional di gameboy */
  object-fit: cover;
  background: #000;
  border: 4px solid #72ff6b; /* cocok dengan tema hijau retro */
  border-radius: 6px;
  box-shadow: 0 4px 0 rgba(0,0,0,0.6);
}

/* tombol ambil 3 foto */
#capture3Btn {
  padding: 10px 12px;
  font-size: 12px;
  border-radius: 8px;
  border: 3px solid #000;
  background: linear-gradient(#9aff9a, #7dff7d);
  cursor: pointer;
  box-shadow: 0 4px 0 #000;
  width: 100%;
}

#capture3Btn:active { transform: translateY(4px); box-shadow: none; 
}

/* countdown besar (angka) */
#countdown {
  font-weight: 700;
  font-size: 16px;
  text-align: center;
  color: #ff4fbf;      /* kontras menyenangkan */
  text-shadow: 0 0 6px rgba(255,0,150,0.25);
  min-height: 24px;
}

/* photo strip preview (di dalam frame polaroid) */
.photo-frame {
  width: 100%;
  max-width: 220px;
  background: #ff80b4;
  padding: 12px;
  border: 12px solid #ff80b4;       /* tebal seperti polaroid */
  box-shadow: 0 6px 0 rgba(0,0,0,0.35);
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  border-radius: 6px;
}

/* area di dalam frame yang berisi strip image */
.photo-frame .strip-holder {
  width: 100%;
  background: #eee;
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 5px solid #000;
}

/* gambar photo strip (vertikal) */
#photoStrip {
  width: 100%;
  height: auto;
  display: block;
  object-fit: contain;
}

/* tombol download */
#downloadStripBtn {
  padding: 8px 10px;
  font-size: 12px;
  border-radius: 8px;
  border: 3px solid #000;
  background: linear-gradient(#ffb3d9, #ff80b4);
  cursor: pointer;
  box-shadow: 0 4px 0 #000;
  width: 100%;
}

#downloadStripBtn:active { transform: translateY(4px); box-shadow: none; }

/* thumbnail kecil (opsional) jika ingin menampilkan satu-satu foto hasil */
.strip-thumb {
  width: 48px;
  height: 64px;
  object-fit: cover;
  border: 3px solid #000;
  background: #fff;
  border-radius: 4px;
}

/* responsif: jika ruang sempit, susun vertikal */
@media (max-width: 640px) {
  .photobooth-wrap { flex-direction: column; gap: 10px; }
  .photo-frame { max-width: 100%; }
  #camera { height: 240px; }
}
/* === GIF PREVIEW CENTER & BIG === */
#gifContainer {
  width: 100%;
  display: flex;
  justify-content: center;
  margin: 10px 0;
}

#gifPreview {
  width: 600px;            /* responsif */
   max-width: 95vw;
   height:auto;      /* BESAR */
  border: 6px solid #000;
  border-radius: 10px;
  display: none;
  box-shadow: 0 6px 0 rgba(0,0,0,0.6);
  background: #fff;
}
#downloadGifBtn {padding:12px 20px ;background:#BFFFFD;color:#000;border:4px solid #000;border-radius:8px;cursor:pointer;user-select: none;}
   #downloadGifBtn:active{
         box-shadow: 0 0 0 #000;
    transform: translateY(4px);
   }
#downloadAllBtn {padding:12px 20px ;background:#BFFFFD;color:#000;border:4px solid #000;border-radius:8px;cursor:pointer;user-select: none;}
   #downloadAllBtn:active{
         box-shadow: 0 0 0 #000;
    transform: translateY(4px);
   }
   #resetBtn {padding:12px 20px ;background:#BFFFFD;color:#000;border:4px solid #000;border-radius:8px;cursor:pointer;user-select: none;}
   #resetBtn:active{
         box-shadow: 0 0 0 #000;
    transform: translateY(4px);
   }
  #password-box {
    background: white;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 0 15px rgba(0,0,0,0.1);
    text-align: center;
  }

  #passwords {
    display: none; /* disembunyikan dulu */
    text-align: center;
  }

  input {
    padding: 8px;
    font-size: 16px;
    text-align: center;
    width: 120px;
  }

  button {
    margin-top: 10px;
    padding: 8px 15px;
    font-size: 16px;
    cursor: pointer;
  }


  /* START SCREEN */
  #startScreen{position:fixed;inset:0;background:#00FFCC;color:#000;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:10000;} 
  #startBtn{padding:30px 200px;background:#BFFFFD;color:#000;border:4px solid #000;border-radius:8px;cursor:pointer;user-select: none;}
   #fullscreenBtn{padding:12px 20px ;background:#BFFFFD;color:#000;border:4px solid #000;border-radius:8px;cursor:pointer;user-select: none;}
   #fullscreenBtn:active{
         box-shadow: 0 0 0 #000;
    transform: translateY(4px);
   }
  #startBtn:active{
    box-shadow: 0 0 0 #000;
    transform: translateY(4px);
  }

    
  /*Ucapan */
  #password-box{background:#FFFFFF}
  #password{background:#FFFFFF}
  #ucapan{background:#FFFFFF}
  #gallery{background:#FFFFFF}
  #photobooth{background:#00FFCC}
  #photoboothh{background:#00FFCC;align-items:center;}
  #inputUName{background:#00FFCC;align-items:center;}
  #music{background:#FFFFFF}
  /**/
  /* FLASH PUTIH */
#flash {
  position: fixed;
  inset: 0;
  background: white;
  opacity: 0;
  pointer-events: none;
  z-index: 99999;
}

/* ANIMASI FLASH */
.flash {
  animation: flashAnim 0.5s ease;
}

@keyframes flashAnim {
  0%   { opacity: 0; }
  20%  { opacity: 1; }
  100% { opacity: 0; }
}

/* ANIMASI COUNTDOWN */
@keyframes pop {
  0% { transform: scale(0.6); opacity: 0; }
  100% { transform: scale(1); opacity: 1; }
}
#userName {
  font-size: 32px;        /* ukuran teks ketikan */
  padding: 16px 20px;     /* tinggi input */
  width: 80%;
  max-width: 500px;
  text-align: center;
  border: 4px solid #000;
  border-radius: 10px;
  outline: none;
}
#userName::placeholder {
  font-size: 28px;
  color: #888;
}

</style>
</head>

<script src="https://cdn.jsdelivr.net/npm/gifshot@0.3.2/build/gifshot.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

<body>
    
<div id="startScreen">
  <div style="font-size:50px;margin-bottom:20px;">PRESS START
  </div><button style="font-size:12px;margin-bottom:20px;display:none" id="fullscreenBtn" onclick="openFullscreen()">FullScreen Mode</button>
<section id="app" class="fullscreen">
</section>
  <button style="font-size:60px" id="startBtn" onclick="openFullscreen()">START</button>
</div>

  <div class="screen-frame">
    <div class="app">
      <div id="main-menu" class="menu">
          <p style="position:absolute;top:0;width:100%;text-align:center;    text-shadow:0 0 6px #00ff41;margin-top:10px;
    font-size:30px;
    padding:0;">PERMATA Bandung Timur Mini App!</p>
        
        <button id="btn" onclick="openSection('inputUName')">üì∏ Mini Photobooth</button>
      </div>

      
<div id="inputUName" class="section">

  <input
  id="userName"
  type="text"
  placeholder="Input Your Name"
  style="padding:20px;font-size:20px;text-align:center"
  maxlength="20">
  <br>
<button id="btn" onclick="openSection('photobooth')">Go!</button>
</div>
    
<div id="photobooth" class="section">
      <div class="screen-frame2">
  <div class="photobooth-wrap">
    <div class="photobooth-left">
      <video id="camera" autoplay playsinline></video>
        
      <button id="capture3Btn" class="btn">Take 3 Foto</button>
    <div id="countdown" style="font-size:70px;margin-top:5px;color:#000"></div>
    
</div></div></div></div>

    <div id="photoboothh" class="section2">
  <h2>Photos Preview</h2>

  <!-- FOTO SATUAN -->
  <div id="singlePhotos"
       style="display:flex;gap:10px;flex-wrap:wrap;justify-content:center;">
  </div>
  <hr style="margin:10px 0;border:2px solid #000">
<button id="downloadAllBtn" class="btn">Download Foto
</button>

<h3>üéûÔ∏è GIF Preview</h3>
<div id="gifContainer">
<img id="gifPreview"
     style="max-width:360px;border:4px solid #000;display:none">
</div>
<br>

<a id="downloadGifBtn"
   style="display:none"
   class="btn"
   download="photobooth.gif">Download GIF
</a>
<p style="font-size:20px">Back to Main Menu</p>
<button
  id="resetBtn" class="btn"
>
  üîÑ Reset
</button>

  <!-- PHOTO STRIP -->
  <img id="photoStrip" style="display:none;max-width:220px">

  <button id="downloadStripBtn" style="display:none">
    ‚¨áÔ∏è Download Photo Strip
  </button>
</div>
</div>
</div>
<!-- FLASH EFFECT -->
<div id="flash"></div>

<!-- SOUNDS -->
<audio id="beepSound" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg"></audio>
<audio id="shutterSound" src="https://actions.google.com/sounds/v1/camera/camera_shutter_click_01.ogg"></audio>


  <div class="btnA" id="btnA" onclick="playClickSound(); handleControl('A')"></div>
  <div class="labelA"></div>
  <div class="btnB" id="btnB" onclick="playClickSound(); handleControl('B')"></div>
  <div class="labelB"></div>
  <div class="selectStart">
    <div class="smallBtn" onclick="playClickSound()"></div>
    <div class="smallBtn" onclick="playClickSound()"></div>
  </div>

  <audio id="clickSound" src="https://actions.google.com/sounds/v1/cartoon/pop.ogg"></audio>

<script>
const startBtn = document.getElementById('startBtn');
const startScreen = document.getElementById('startScreen');
const loadingScreen = null;
const pixelBars = [];
const clickSound = document.getElementById('clickSound');

// --- 1. START SCREEN & LOADING LOGIC ---
startBtn.onclick = () => {
  playClickSound();
  startScreen.style.display = 'none';


  let index = 0;
  const loadingInterval = setInterval(() => {
    if (index < pixelBars.length) {
      pixelBars[index].style.opacity = '1';
      index++;
    } else {
      clearInterval(loadingInterval);
      setTimeout(() => {
        loadingScreen.style.opacity = '0';
        setTimeout(() => loadingScreen.style.display = 'none', 500);
      }, 300);
    }
  }, 120);
};

function playClickSound() {
    clickSound.currentTime = 0;
 
}

// --- 2. MENU NAVIGATION ---
function openSection(id) {
  playClickSound();
  document.getElementById('main-menu').style.display = 'none';
  document.querySelectorAll('.section').forEach(s => s.style.display = 'none');
  const section = document.getElementById(id);
  section.style.display = 'flex';
  section.style.flexDirection = 'column';
  
  // Spesifik untuk Photobooth: mulai kamera
  if (id === 'photobooth') {
      startCamera();
  }
}

function backMenu() {
  playClickSound();
  stopCamera(); // Stop camera just in case
  document.querySelectorAll('.section').forEach(s => s.style.display = 'none');
  document.getElementById('main-menu').style.display = 'grid';
}

// --- 3. PHOTOBOOTH LOGIC ---
/* ============================================================
   PHOTOBOOTH - AMBIL 3 FOTO + BUAT PHOTO STRIP + DOWNLOAD
   ============================================================ */

let stream2 = null;
const camera2 = document.getElementById("camera");
const capture3Btn = document.getElementById("capture3Btn");
const countdown = document.getElementById("countdown");
const photoStrip = document.getElementById("photoStrip");
const downloadStripBtn = document.getElementById("downloadStripBtn");
const opencetak =  document.getElementById("opencetak");

// START CAMERA (gunakan fungsi existing kamu)
async function startCamera() {
    try {
        stream2 = await navigator.mediaDevices.getUserMedia({
            video: { facingMode: "user", width: { ideal: 640 }, height: { ideal: 500 } }
        });

        camera2.srcObject = stream2;
    } catch (err) {
        console.error("Kamera error:", err);
        alert("Tidak bisa mengakses kamera.");
    }
}

function stopCamera() {
    if (stream2) {
        stream2.getTracks().forEach(track => track.stop());
        camera2.srcObject = null;
        stream2 = null;
    }
}

/* 
   AMBIL 3 FOTO OTOMATIS
*/
let singlePhotosData = [];
const rawName = document.getElementById("userName").value;
const safeName = sanitizeFileName(rawName);

async function takeThreePhotos() {
  if (!stream2) {
    alert("Kamera belum aktif!");
    return;
  }

  capture3Btn.disabled = true;
  document.getElementById("capture3Btn").style.display = "none";
  
  singlePhotosData = [];

  const canvasPhoto = document.createElement("canvas");
  const ctx = canvasPhoto.getContext("2d");

  canvasPhoto.width = camera2.videoWidth;
  canvasPhoto.height = camera2.videoHeight;
  
    ctx.imageSmoothingEnabled = true;
// gambar video ke canvas

  
  for (let i = 0; i < 3; i++) {
    await countdownMundur(10);
    
    doFlash();
    playShutter();
    
    ctx.save();
    // üî• CLEAR CANVAS
    ctx.setTransform(1, 0, 0, 1, 0, 0);
    ctx.clearRect(0, 0, canvasPhoto.width, canvasPhoto.height);

    // üî• MIRROR FOTO
    ctx.translate(canvasPhoto.width, 0);
    ctx.scale(-1, 1);

    ctx.drawImage(camera2, 0, 0, canvasPhoto.width, canvasPhoto.height);
    ctx.restore();
    const dataUrl = canvasPhoto.toDataURL("image/png");
    singlePhotosData.push(dataUrl);

    countdown.textContent = `Photo ${i + 1} ‚úì`;
     await new Promise(r => setTimeout(r, 2000));
    countdown.textContent = "";
  }
  countdown.textContent = "";
  tampilkanFotoSatuan();
  buatGIF();
  openSection("photoboothh");
}

function tampilkanFotoSatuan() {
  const container = document.getElementById("singlePhotos");
  container.innerHTML = "";

  singlePhotosData.forEach((src, i) => {
    const box = document.createElement("div");
    box.style.textAlign = "center";

    box.innerHTML = `
      <img src="${src}" style="width:400px;border:4px solid #000;border-radius:6px">
      <br>    `;

    container.appendChild(box);
  });
}
function downloadAllPhotos() {
  const rawName = document.getElementById("userName").value;
  const name = sanitizeFileName(rawName);

  singlePhotosData.forEach((src, i) => {
    const a = document.createElement("a");
    a.href = src;
    a.download = `${name}${i + 1}.png`;
    a.click();
  });
}

document
  .getElementById("downloadAllBtn")
  .addEventListener("click", downloadAllPhotos);
  
const rawgifName = document.getElementById("userName").value;
const gifname = sanitizeFileName(rawgifName);

function base64ToBlob(base64, mime) {
  const byteChars = atob(base64.split(",")[1]);
  const byteNumbers = new Array(byteChars.length);
  for (let i = 0; i < byteChars.length; i++) {
    byteNumbers[i] = byteChars.charCodeAt(i);
  }
  return new Blob([new Uint8Array(byteNumbers)], { type: mime });
}

function buatGIF() {
  if (singlePhotosData.length === 0) return;

  const rawgifName = document.getElementById("userName").value;
  const gifname = sanitizeFileName(rawgifName);

  gifshot.createGIF(
    {
      images: singlePhotosData,
      gifWidth: 640,
      gifHeight: 480,
      interval: 0.8
    },
    function (obj) {
      if (obj.error) {
        alert("Gagal membuat GIF");
        return;
      }

      const gifImg = document.getElementById("gifPreview");
      const downloadBtn = document.getElementById("downloadGifBtn");

      // tampilkan preview
      gifImg.src = obj.image;
      gifImg.style.display = "block";

      // convert base64 ‚Üí blob (WAJIB agar download jalan)
      const gifBlob = base64ToBlob(obj.image, "image/gif");
      const gifUrl = URL.createObjectURL(gifBlob);

      downloadBtn.href = gifUrl;
      downloadBtn.download = `${gifname}_photobooth.gif`;
      downloadBtn.style.display = "inline-block";
    }
  );
}

/*
   BUAT PHOTO STRIP (3 foto vertical)
*/
function createPhotoStrip(photos) {
  const stripCanvas = document.createElement("canvas");
  const ctx = stripCanvas.getContext("2d");

  const width = 640;
  const height = 480 * 3;

  stripCanvas.width = width;
  stripCanvas.height = height;

  let loaded = 0;

  photos.forEach((src, i) => {
    const img = new Image();
    img.src = src;

    img.onload = () => {
      ctx.drawImage(img, 0, i * 480, width, 480);
      loaded++;

      if (loaded === 3) {
        const finalStrip = stripCanvas.toDataURL("image/png");
        photoStrip.src = finalStrip;
        photoStrip.style.display = "block";
        downloadStripBtn.style.display = "block";
      }
    };
  });
}


/* DOWNLOAD PHOTO STRIP */
downloadStripBtn.addEventListener("click", () => {
    const link = document.createElement("a");
    link.href = photoStrip.src;
    link.download = "photo-strip.png";
    link.click();
});

/*
   BUTTON LISTENER
*/
capture3Btn.addEventListener("click", () => {
    takeThreePhotos();
});


//password
  function checkPass() {
    const correct = "131204"; // ‚Üê ubah password sesuai keinginanmu
    const input = document.getElementById("pass").value;

    if (input === correct) {
      document.getElementById("masuk").style.display = "block";
      document.getElementById("berhasil").style.display = "block";
    } else {
      document.getElementById("error").style.display = "block";
    }
    setTimeout(() => {
    document.getElementById("error").style.display = "none";
  }, 3000); // 3000 ms = 3 detik
    setTimeout(() => {
    document.getElementById("masuk").style.display = "none";
  }, 5000); // 3000 ms = 3 detik
   setTimeout(() => {
    document.getElementById("berhasil").style.display = "none";
  }, 5000); // 3000 ms = 3 detik
  };
  
  // music
  function playMusic() {
  const audio = document.getElementById("bgm");
  audio.volume = 0.99; // 0.0 - 1.0
  audio.play();
}
function pauseMusic(){ 
    const audio = document.getElementById("bgm");
    audio.pause();      // stop

}
  // music
  function playMusic1() {
  const audio = document.getElementById("bgm1");
  audio.volume = 0.99; // 0.0 - 1.0
  audio.play();
}
function pauseMusic1(){ 
    const audio = document.getElementById("bgm1");
    audio.pause();      // stop
}
  // music
  function playMusic2() {
  const audio = document.getElementById("bgm2");
  audio.volume = 0.99; // 0.0 - 1.0
  audio.play();
}
function pauseMusic2(){ 
    const audio = document.getElementById("bgm2");
    audio.pause();      // stop
}
  // music
  function playMusic3() {
  const audio = document.getElementById("bgm3");
  audio.volume = 0.99; // 0.0 - 1.0
  audio.play();
}
function pauseMusic3(){ 
    const audio = document.getElementById("bgm3");
    audio.pause();      // stop

}
// --- 5. PHYSICAL BUTTON CONTROL (A/B) ---
function handleControl(button) {
    const currentSection = document.querySelector('.section[style*="display: block"]');

    if (!currentSection) {
        return;
    }

    if (button === 'B') {
        if (currentSection.id === 'photobooth') {
            stopCamera();
        }
        backMenu();
        return;
    }

    if (button === 'A') {
        if (currentSection.id === 'photobooth') {
            captureBtn.click(); 
        } 
    }
}

// Tambahkan efek tekan visual pada tombol fisik
document.querySelectorAll('.btnA, .btnB').forEach(btn => {
    btn.addEventListener('mousedown', () => btn.classList.add('active'));
    btn.addEventListener('mouseup', () => btn.classList.remove('active'));
    btn.addEventListener('mouseleave', () => btn.classList.remove('active')); 
});

function openFullscreen() {
  const elem = document.documentElement;

  if (elem.requestFullscreen) {
    elem.requestFullscreen();
  } else if (elem.webkitRequestFullscreen) {
    elem.webkitRequestFullscreen(); // Safari
  } else if (elem.msRequestFullscreen) {
    elem.msRequestFullscreen(); // IE11
  }
}
const flash = document.getElementById("flash");
const beepSound = document.getElementById("beepSound");
const shutterSound = document.getElementById("shutterSound");

function playBeep() {
  beepSound.currentTime = 0;
  beepSound.play();
}

function playShutter() {
  shutterSound.currentTime = 0;
  shutterSound.play();
}

function doFlash() {
  flash.classList.remove("flash");
  void flash.offsetWidth; // reflow
  flash.classList.add("flash");
}
function countdownMundur(detik) {
  return new Promise(resolve => {
    let sisa = detik;

    countdown.style.fontSize = "70px";
    countdown.style.color = "#000";
    countdown.style.fontfamily ="Cursive";

    const timer = setInterval(() => {
      countdown.textContent = sisa;
      countdown.style.animation = "pop 1s ease";
      playBeep();

      sisa--;

      if (sisa < 0) {
        clearInterval(timer);
        countdown.textContent = "üì∏";
        resolve();
      }
    }, 1000);
  });
}
function sanitizeFileName(name) {
  return name
    .trim()
    .toLowerCase()
    .replace(/\s+/g, "_")       // spasi ‚Üí _
    .replace(/[^a-z0-9_-]/g, "") // hapus simbol
    || "gueststar";
}
function resetKeAwal() {
  // STOP kamera

  // RESET data
  singlePhotosData = [];

  // RESET preview foto satuan
  const singlePhotos = document.getElementById("singlePhotos");
  if (singlePhotos) singlePhotos.innerHTML = "";

  // RESET GIF
  const gifPreview = document.getElementById("gifPreview");
  const downloadGifBtn = document.getElementById("downloadGifBtn");
  if (gifPreview) {
    gifPreview.src = "";
    gifPreview.style.display = "none";
  }
  if (downloadGifBtn) {
    downloadGifBtn.href = "";
    downloadGifBtn.style.display = "none";
  }

  // RESET photo strip (jika ada)
  const photoStrip = document.getElementById("photoStrip");
  if (photoStrip) {
    photoStrip.src = "";
    photoStrip.style.display = "none";
  }

  // RESET input nama
  const nameInput = document.getElementById("userName");
  if (nameInput) nameInput.value = "";

  // RESET tombol capture
  capture3Btn.disabled = false;
  capture3Btn.style.display = "block";

  // RESET countdown
  countdown.textContent = "";

  // KEMBALI KE MENU AWAL
  document.querySelectorAll(".section, .section2").forEach(s => {
    s.style.display = "none";
  });
  document.getElementById("main-menu").style.display = "flex";
}
document
  .getElementById("resetBtn")
  .addEventListener("click", resetKeAwal);

</script>
